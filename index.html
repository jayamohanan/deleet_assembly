<!-- Kerala Local Bodies Map -->
<!-- VERSION 1.6 -->
<!-- Reminder: Please increment the version number above every time you update this file -->

<!DOCTYPE html>
<html>
<head>
  <title>Kerala Local Bodies Map</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    body { margin: 0; padding: 0; }
    #map { width: 100%; height: 90vh; }

    #controls {
      padding: 10px;
      background: #f9f9f9;
      border-bottom: 1px solid #ccc;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .control-row {
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }

    .control-row label {
      font-size: 14px;
      font-weight: bold;
    }

    .control-row input[type="text"],
    .control-row input[type="color"],
    .control-row input[type="range"] {
      padding: 4px;
      font-size: 14px;
    }

    .control-row input[type="text"] {
      width: 160px;
    }

    .control-row input[type="range"] {
      width: 120px;
    }
  </style>
</head>
<body>

<div id="controls">
  <div class="control-row">
    <label>District Name:</label>
    <input type="text" id="districtName" placeholder="Enter district name">
    <label>Boundary Color:</label>
    <input type="color" id="districtColor" value="#3388ff">
    <label>Transparency:</label>
    <input type="range" id="districtOpacity" min="0" max="1" step="0.1" value="0.2">
  </div>

  <div class="control-row">
    <label>Assembly Name:</label>
    <input type="text" id="assemblyName" placeholder="Enter assembly name">
    <label>Boundary Color:</label>
    <input type="color" id="assemblyColor" value="#ff3333">
    <label>Transparency:</label>
    <input type="range" id="assemblyOpacity" min="0" max="1" step="0.1" value="0.2">
  </div>
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
  const map = L.map('map').setView([10.35, 76.27], 8);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: 'Â© OpenStreetMap'
  }).addTo(map);

  // Load GeoJSON files
  let districtLayer, assemblyLayer;

  fetch('district_V15.geojson')
    .then(res => res.json())
    .then(data => {
      districtLayer = L.geoJSON(data, {
        style: {
          color: document.getElementById('districtColor').value,
          weight: 2,
          opacity: 1,
          fillOpacity: document.getElementById('districtOpacity').value
        },
        onEachFeature: (feature, layer) => {
          layer.bindPopup("District: " + feature.properties.Name);
        }
      }).addTo(map);
    });

  fetch('assembly_V15.geojson')
    .then(res => res.json())
    .then(data => {
      assemblyLayer = L.geoJSON(data, {
        style: {
          color: document.getElementById('assemblyColor').value,
          weight: 2,
          opacity: 1,
          fillOpacity: document.getElementById('assemblyOpacity').value
        },
        onEachFeature: (feature, layer) => {
          layer.bindPopup("Assembly: " + feature.properties.Name);
        }
      }).addTo(map);
    });

  // Controls
  document.getElementById('districtColor').addEventListener('input', e => {
    if (districtLayer) districtLayer.setStyle({ color: e.target.value });
  });
  document.getElementById('districtOpacity').addEventListener('input', e => {
    if (districtLayer) districtLayer.setStyle({ fillOpacity: e.target.value });
  });

  document.getElementById('assemblyColor').addEventListener('input', e => {
    if (assemblyLayer) assemblyLayer.setStyle({ color: e.target.value });
  });
  document.getElementById('assemblyOpacity').addEventListener('input', e => {
    if (assemblyLayer) assemblyLayer.setStyle({ fillOpacity: e.target.value });
  });

  // Search by name
  document.getElementById('districtName').addEventListener('change', e => {
    const name = e.target.value.toLowerCase();
    districtLayer.eachLayer(layer => {
      if (layer.feature.properties.Name.toLowerCase() === name) {
        map.fitBounds(layer.getBounds());
        layer.openPopup();
      }
    });
  });

  document.getElementById('assemblyName').addEventListener('change', e => {
    const name = e.target.value.toLowerCase();
    assemblyLayer.eachLayer(layer => {
      if (layer.feature.properties.Name.toLowerCase() === name) {
        map.fitBounds(layer.getBounds());
        layer.openPopup();
      }
    });
  });
</script>
</body>
</html>
