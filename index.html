<!-- VERSION: v1.4 -->

<!DOCTYPE html>
<html>
<head>
  <title>Kerala Local Bodies Map</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <!-- jQuery + jQuery UI for Auto-suggest -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.0/themes/base/jquery-ui.css" />
  <script src="https://code.jquery.com/ui/1.13.0/jquery-ui.min.js"></script>

  <style>
    body { margin: 0; padding: 0; }
    #map { width: 100%; height: 100vh; }

    /* Floating panel for inputs */
    #control-panel {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 1000;
      background: white;
      padding: 12px;
      border-radius: 8px;
      box-shadow: 0px 2px 6px rgba(0,0,0,0.3);
      font-family: Arial, sans-serif;
    }

    #control-panel input, #control-panel button {
      margin: 4px 0;
      padding: 6px;
      font-size: 14px;
      width: 200px;
    }

    #control-panel button {
      cursor: pointer;
      background: #2c7be5;
      border: none;
      color: white;
      border-radius: 4px;
    }

    /* Version number overlay (always visible on top right) */
    #version-label {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 2000; /* higher than control-panel */
      background: rgba(0,0,0,0.7);
      color: white;
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 12px;
      font-family: Arial, sans-serif;
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <!-- Input controls -->
  <div id="control-panel">
    <label for="districtInput">District:</label><br>
    <input type="text" id="districtInput" placeholder="Enter district name"><br>

    <label for="assemblyInput">Assembly:</label><br>
    <input type="text" id="assemblyInput" placeholder="Enter assembly name"><br>

    <button onclick="drawBoundaries()">Draw Boundaries</button>
  </div>

  <!-- Version overlay -->
  <div id="version-label">Version: v1.4</div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    var map = L.map('map').setView([10.0, 76.5], 7);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: 'Â© OpenStreetMap contributors'
    }).addTo(map);

    var geojsonLayer;

    // Sample data for auto-suggest
    var districts = ["Kasargod", "Kannur", "Wayanad", "Kozhikode", "Malappuram", "Palakkad", "Thrissur", "Eranakulam", "Idukki", "Kottayam", "Alappuzha", "Pathanamthitta", "Kollam", "Thiruvananthapuram"];
    var assemblies = ["Manjeshwar", "Kasargod", "Kanhangad", "Uduma", "Kanhangad", "Thalassery", "Kozhikode North", "Kozhikode South", "Palakkad", "Thrissur", "Kottayam", "Alappuzha", "Kollam", "Neyyattinkara"];

    $(function() {
      $("#districtInput").autocomplete({ source: districts });
      $("#assemblyInput").autocomplete({ source: assemblies });
    });

    function drawBoundaries() {
      var district = document.getElementById("districtInput").value.trim();
      var assembly = document.getElementById("assemblyInput").value.trim();

      if (!district && !assembly) {
        alert("Please enter at least a district or assembly name.");
        return;
      }

      if (geojsonLayer) {
        map.removeLayer(geojsonLayer);
      }

      // Simulated GeoJSON (replace with real one)
      var sampleGeoJSON = {
        "type": "FeatureCollection",
        "features": [
          {
            "type": "Feature",
            "properties": { "district": "Kozhikode", "assembly": "Kozhikode North" },
            "geometry": {
              "type": "Polygon",
              "coordinates": [[[75.75,11.25],[75.85,11.25],[75.85,11.35],[75.75,11.35],[75.75,11.25]]]
            }
          },
          {
            "type": "Feature",
            "properties": { "district": "Palakkad", "assembly": "Palakkad" },
            "geometry": {
              "type": "Polygon",
              "coordinates": [[[76.5,10.7],[76.6,10.7],[76.6,10.8],[76.5,10.8],[76.5,10.7]]]
            }
          }
        ]
      };

      geojsonLayer = L.geoJSON(sampleGeoJSON, {
        filter: function(feature) {
          return (!district || feature.properties.district.toLowerCase() === district.toLowerCase()) &&
                 (!assembly || feature.properties.assembly.toLowerCase() === assembly.toLowerCase());
        },
        style: { color: "red", weight: 2, fillOpacity: 0.2 },
        onEachFeature: function(feature, layer) {
          layer.bindPopup("District: " + feature.properties.district + "<br>Assembly: " + feature.properties.assembly);
        }
      }).addTo(map);

      map.fitBounds(geojsonLayer.getBounds());
    }
  </script>
</body>
</html>

<!--
FEATURES:
1. Shows a Kerala map with OpenStreetMap tiles.
2. Provides input fields for District and Assembly names.
3. Inputs have auto-suggest/autocomplete enabled.
4. Boundaries are drawn only when the button is clicked and inputs are provided.
5. Only boundaries matching the district/assembly entered are drawn.
6. Popups display District and Assembly names when clicked.
7. Version number shown at the top-right corner, always visible.
8. Version number also placed as a comment at the top for quick verification.

EDITOR INSTRUCTIONS:
- Always update the version number both at the top comment and in the on-screen overlay.
- Keep version overlay on top of all elements (use high z-index).
- Add new features in the bottom comment section so next editors understand the structure.
- Maintain autocomplete sources for district and assembly lists.
- Replace `sampleGeoJSON` with actual Kerala district/assembly GeoJSON for real use.
-->
