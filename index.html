<!-- README: Increment version number every time you update this file -->
<!DOCTYPE html>
<html>
<head>
  <title>Kerala Local Bodies Map - v16</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    body { margin: 0; padding: 0; font-family: Arial, sans-serif; }
    #map { width: 100%; height: 90vh; }
    .controls {
      padding: 10px;
      background: #f4f4f4;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .control-group {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .control-group input[type="text"],
    .control-group input[type="color"],
    .control-group input[type="number"] {
      padding: 4px;
    }
    .control-group label {
      margin-right: 4px;
    }
    button {
      padding: 5px 10px;
      cursor: pointer;
      border: none;
      background: #0078d7;
      color: white;
      border-radius: 4px;
    }
    button:hover {
      background: #005a9e;
    }
  </style>
</head>
<body>
  <div class="controls">
    <!-- District Controls -->
    <div class="control-group">
      <label for="districtInput">District:</label>
      <input id="districtInput" type="text" list="districtList" placeholder="Enter district name" />
      <datalist id="districtList"></datalist>
      <label for="districtColor">Color:</label>
      <input id="districtColor" type="color" value="#FF0000" />
      <label for="districtOpacity">Opacity:</label>
      <input id="districtOpacity" type="number" step="0.1" min="0" max="1" value="0.5" />
      <button onclick="drawBoundary('district')">Add</button>
    </div>

    <!-- Assembly Controls -->
    <div class="control-group">
      <label for="assemblyInput">Assembly:</label>
      <input id="assemblyInput" type="text" list="assemblyList" placeholder="Enter assembly name" />
      <datalist id="assemblyList"></datalist>
      <label for="assemblyColor">Color:</label>
      <input id="assemblyColor" type="color" value="#0000FF" />
      <label for="assemblyOpacity">Opacity:</label>
      <input id="assemblyOpacity" type="number" step="0.1" min="0" max="1" value="0.5" />
      <button onclick="drawBoundary('assembly')">Add</button>
    </div>
  </div>

  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // Initialize map
    const map = L.map('map').setView([10.0, 76.5], 7);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: 'Â© OpenStreetMap contributors'
    }).addTo(map);

    let districtData, assemblyData;

    // Load District GeoJSON
    fetch('district_V15.geojson')
      .then(res => res.json())
      .then(data => {
        districtData = data;
        populateDatalist('districtList', data, 'DISTRICT');
      });

    // Load Assembly GeoJSON
    fetch('assembly_V15.geojson')
      .then(res => res.json())
      .then(data => {
        assemblyData = data;
        populateDatalist('assemblyList', data, 'Name');
      });

    function populateDatalist(datalistId, geojson, field) {
      const names = [...new Set(geojson.features.map(f => f.properties[field]))];
      const datalist = document.getElementById(datalistId);
      names.forEach(name => {
        const option = document.createElement('option');
        option.value = name;
        datalist.appendChild(option);
      });
    }

    function drawBoundary(type) {
      let input, color, opacity, data, field;

      if (type === 'district') {
        input = document.getElementById('districtInput').value;
        color = document.getElementById('districtColor').value;
        opacity = parseFloat(document.getElementById('districtOpacity').value);
        data = districtData;
        field = 'DISTRICT';
      } else {
        input = document.getElementById('assemblyInput').value;
        color = document.getElementById('assemblyColor').value;
        opacity = parseFloat(document.getElementById('assemblyOpacity').value);
        data = assemblyData;
        field = 'Name';
      }

      if (!input || !data) return;

      const layer = L.geoJSON(data, {
        filter: f => f.properties[field] === input,
        style: {
          color: color,
          weight: 2,
          fillOpacity: opacity
        }
      }).addTo(map);

      map.fitBounds(layer.getBounds());
    }
  </script>
</body>
</html>
